# User 도메인 트러블슈팅 시나리오

## 발생 가능한 문제 상황들

### 1. Refresh Token 동시 갱신 문제
- **시나리오**: 여러 기기에서 동시에 Refresh Token으로 Access Token 갱신 시도
- **재현 방법**: 여러 기기에서 동시에 `/api/auth/refresh` 호출
- **예상 증상**: Refresh Token 불일치, 로그아웃 처리

### 2. 경고 횟수 동시 증가 문제
- **시나리오**: 여러 관리자가 동시에 같은 사용자에게 경고 부여
- **재현 방법**: 동시에 여러 관리자가 경고 부여
- **예상 증상**: 경고 횟수 부정확, 자동 이용제한 중복 적용

### 3. 회원가입 시 중복 체크 성능 저하
- **시나리오**: 회원가입 시 ID, 이메일, 닉네임 중복 체크를 각각 개별 쿼리로 실행
- **재현 방법**: 회원가입 API 호출 시 로그 확인
- **예상 증상**: 3개 쿼리 실행, 응답 시간 증가

### 4. 로그인 시 제재 상태 확인 성능 저하
- **시나리오**: 로그인 시 제재 이력을 매번 조회하여 성능 저하
- **재현 방법**: 로그인 API 호출 시 쿼리 확인
- **예상 증상**: 제재 이력 조회 쿼리 발생, 응답 시간 증가

### 5. 반려동물 목록 조회 N+1 문제
- **시나리오**: 사용자 프로필 조회 시 반려동물 목록 조회 후 각 반려동물의 이미지를 개별 쿼리로 조회
- **재현 방법**: 반려동물이 많은 사용자의 프로필 조회 시 로그 확인
- **예상 증상**: 반려동물마다 이미지 조회 쿼리 발생

### 6. 사용자 프로필 수정 시 동시성 문제
- **시나리오**: 여러 기기에서 동시에 프로필 수정 시도
- **재현 방법**: 동시에 프로필 수정 API 호출
- **예상 증상**: 마지막 수정만 반영, Lost Update 발생

### 7. 소셜 로그인 시 중복 계정 생성
- **시나리오**: 소셜 로그인 시 기존 계정 확인 로직 누락
- **재현 방법**: 같은 소셜 계정으로 여러 번 로그인 
- **예상 증상**: 중복 계정 생성

### 8. 비밀번호 변경 시 보안 문제
- **시나리오**: 비밀번호 변경 시 기존 비밀번호 확인 없이 변경 가능
- **재현 방법**: 비밀번호 변경 API 호출 시 기존 비밀번호 확인 로직 확인
- **예상 증상**: 기존 비밀번호 없이 변경 가능

