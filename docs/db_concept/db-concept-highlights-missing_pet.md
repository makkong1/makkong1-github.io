# DB 개념 어필 포인트 (SQL 제외)

## 1. N+1 문제 이해 및 해결 전략

### 어필 포인트
- **문제 인식**: 게시글 목록 조회 시 각 게시글의 댓글을 개별 쿼리로 조회하는 N+1 문제 발견
- **해결 전략**: Converter 메서드 분리와 배치 조회를 통해 쿼리 수를 105개 → 3개로 감소 (97% 개선)
- **DB 관점**: 
  - 데이터베이스 연결 풀 부하 감소
  - 네트워크 라운드트립 최소화
  - DB 서버 부하 분산

### 말할 내용
> "게시글 목록 조회 시 N+1 문제를 발견하고 해결한 경험이 있습니다. 103개 게시글 조회 시 각 게시글의 댓글을 개별 쿼리로 조회하여 총 105개의 쿼리가 발생했는데, 이를 Converter 메서드 분리와 배치 조회로 변경하여 3개로 줄였습니다. 이 과정에서 데이터베이스 연결 풀의 부하를 크게 줄이고, 네트워크 라운드트립을 최소화했습니다."

---

## 2. 인덱스 활용 전략

### 어필 포인트
- **인덱스 이해**: `WHERE board_idx IN (...)` 쿼리에서 인덱스 활용
- **복합 인덱스 설계**: `(board_idx, is_deleted)` 같은 복합 인덱스 고려
- **쿼리 최적화**: IN 절을 사용한 배치 조회 시 인덱스 효율성 이해
- **GROUP BY 최적화**: 댓글 수 배치 조회 시 GROUP BY 활용

### 말할 내용
> "배치 조회를 위해 IN 절을 사용할 때, 데이터베이스가 인덱스를 효율적으로 활용할 수 있도록 복합 인덱스를 설계했습니다. 댓글 수 조회를 위한 `(board_idx, is_deleted)` 복합 인덱스를 통해 조회 성능을 향상시켰습니다. 또한 GROUP BY를 활용하여 여러 게시글의 댓글 수를 한 번에 조회하도록 최적화했습니다."

---

## 3. ORM 최적화 (JPA/Hibernate)

### 어필 포인트
- **LAZY 로딩 트리거 방지**: 댓글 필드를 전혀 접근하지 않아 LAZY 로딩 트리거 방지
- **Converter 메서드 분리**: 목록 조회용과 상세 조회용 Converter 메서드 분리
- **엔티티 설계**: 연관 관계 설계 시 성능 고려
- **서비스 분리**: 게시글과 댓글 서비스 분리로 조인 폭발 방지

### 말할 내용
> "JPA의 LAZY 로딩으로 인해 댓글 정보를 각 게시글마다 개별 쿼리로 조회하는 문제를 발견했습니다. 이를 해결하기 위해 목록 조회 시 댓글 필드를 전혀 접근하지 않는 별도의 Converter 메서드를 만들었습니다. 또한 게시글과 댓글 서비스를 분리하여 조인 폭발을 방지하고 확장성을 향상시켰습니다."

---

## 4. 데이터베이스 연결 풀 관리

### 어필 포인트
- **연결 풀 부하 인식**: N+1 문제로 인한 연결 풀 고갈 위험 이해
- **해결 효과**: 쿼리 수 감소로 연결 풀 사용량 대폭 감소
- **동시성 고려**: 동시 조회 시나리오에서도 안정적인 성능 유지

### 말할 내용
> "N+1 문제로 인해 단일 요청당 105개의 쿼리가 발생하면서 데이터베이스 연결 풀의 부하가 증가했습니다. 이를 3개로 줄임으로써 연결 풀 사용량을 약 97% 감소시켰고, 동시 사용자 증가 시에도 안정적인 성능을 유지할 수 있게 되었습니다."

---

## 5. 트랜잭션 관리 및 성능

### 어필 포인트
- **트랜잭션 범위 이해**: 배치 조회는 트랜잭션 내에서 실행되어야 함
- **트랜잭션 격리 수준**: 읽기 작업의 일관성 보장
- **성능 최적화**: 트랜잭션 범위 최소화

### 말할 내용
> "배치 조회를 트랜잭션 내에서 실행하여 데이터 일관성을 보장했습니다. 또한 트랜잭션 범위를 최소화하여 락 경합을 줄이고 성능을 최적화했습니다."

---

## 6. 쿼리 실행 계획 분석

### 어필 포인트
- **성능 측정**: 실제 운영 환경에서 쿼리 수와 실행 시간 측정
- **실행 시간 분석**: 571ms → 106ms로 개선 (81% 개선)
- **모니터링**: 실제 운영 환경에서의 성능 모니터링 경험

### 말할 내용
> "실제 운영 환경에서 쿼리 실행 수와 실행 시간을 측정하고, 성능 개선 효과를 정량적으로 확인했습니다. 실행 시간을 571ms에서 106ms로 줄여 약 81%의 성능 향상을 달성했습니다."

---

## 7. 데이터베이스 설계 원칙

### 어필 포인트
- **정규화**: 엔티티 간 관계 설계
- **역정규화 고려**: 성능 최적화를 위한 조회 패턴 고려
- **인덱스 설계**: 조회 패턴에 맞는 인덱스 설계
- **서비스 분리**: 게시글과 댓글 서비스 분리로 아키텍처 개선

### 말할 내용
> "게시글과 댓글 간의 관계를 설계할 때, 조회 패턴을 고려하여 인덱스를 설계했습니다. 특히 배치 조회를 위한 복합 인덱스를 설계하여 조회 성능을 최적화했습니다. 또한 게시글과 댓글 서비스를 분리하여 조인 폭발을 방지하고 확장성을 향상시켰습니다."

---

## 8. 메모리 관리 및 GC 최적화

### 어필 포인트
- **메모리 사용량 측정**: 11MB → 3MB (73% 감소)
- **불필요한 데이터 로드 방지**: 댓글 목록을 접근하지 않아 메모리 사용량 감소
- **GC 부하 감소**: 메모리 사용량 감소로 GC 부하 감소

### 말할 내용
> "LAZY 로딩으로 인해 불필요한 댓글 데이터가 메모리에 로드되는 문제를 발견하고, 목록 조회 시 댓글을 전혀 접근하지 않도록 최적화했습니다. 이를 통해 메모리 사용량을 73% 감소시켰고, GC 부하를 줄여 서버 안정성을 향상시켰습니다."

---

## 9. 확장성 고려한 설계

### 어필 포인트
- **선형 확장성**: 게시글 수가 증가해도 쿼리 수는 일정하게 유지
- **확장성 테스트**: 게시글 103개 기준으로 테스트, 1000개여도 동일한 쿼리 수
- **성능 예측**: 데이터 증가에 따른 성능 저하 최소화
- **조인 폭발 방지**: 댓글을 별도 API로 조회하여 조인 폭발 방지

### 말할 내용
> "배치 조회 패턴을 적용하여 게시글 수가 증가해도 쿼리 수는 일정하게 유지되도록 설계했습니다. 게시글 103개든 1000개든 동일하게 3개의 쿼리만 실행되어, 서비스 확장에 유리한 구조를 만들었습니다. 또한 댓글을 별도 API로 조회하여 조인 폭발을 방지하고 확장성을 향상시켰습니다."

---

## 10. 아키텍처 개선

### 어필 포인트
- **서비스 분리**: 게시글과 댓글 서비스를 분리하여 책임 분리
- **API 설계**: 목록 조회와 상세 조회를 분리하여 필요한 데이터만 조회
- **조인 폭발 방지**: 댓글이 많은 게시글에서도 안정적인 성능 유지

### 말할 내용
> "게시글과 댓글 서비스를 분리하여 책임을 명확히 했습니다. 목록 조회 시에는 댓글을 제외하고, 댓글이 필요한 경우 별도 API로 조회하도록 설계했습니다. 이를 통해 조인 폭발을 방지하고 확장성을 향상시켰습니다."

---

## 11. 실제 운영 경험

### 어필 포인트
- **성능 측정**: 실제 운영 환경에서 성능 측정
- **문제 해결 과정**: 문제 발견 → 분석 → 해결 → 검증의 전체 과정
- **문서화**: 트러블슈팅 문서를 통한 지식 공유

### 말할 내용
> "실제 운영 중인 서비스에서 성능 문제를 발견하고, Converter 메서드 분리와 배치 조회로 해결했습니다. 전체 과정을 문서화하여 팀 내 지식 공유를 했습니다."

---

## 면접 대답 구성 예시

### 질문: "DB 관련 경험이 있나요?"

**대답 구조:**
1. **문제 발견** (30초)
   - "실제 운영 중인 게시판 서비스에서 게시글 목록 조회 시 성능 저하를 발견했습니다."
   - "103개 게시글 조회 시 총 105개의 쿼리가 발생하고 있었습니다."

2. **원인 분석** (1분)
   - "N+1 문제였습니다. 게시글 목록을 조회한 후, 각 게시글마다 댓글을 개별 쿼리로 조회하고 있었습니다."
   - "또한 LAZY 로딩으로 인해 목록 조회 시 댓글이 필요 없는데도 모든 댓글을 메모리에 로드하고 있었습니다."

3. **해결 방법** (1분)
   - "목록 조회용 Converter 메서드를 별도로 만들어 댓글 필드를 전혀 접근하지 않도록 했습니다."
   - "댓글 수가 필요한 경우 배치 조회로 한 번에 조회하도록 변경했습니다."
   - "댓글 목록은 별도 API로 조회하도록 아키텍처를 개선했습니다."

4. **결과 및 학습** (30초)
   - "쿼리 수를 105개에서 3개로 줄여 97% 개선했고, 실행 시간도 571ms에서 106ms로 81% 개선했습니다."
   - "이 과정에서 LAZY 로딩 트리거 방지, 배치 조회, 아키텍처 개선 등 DB 관련 개념을 깊이 이해하게 되었습니다."

---

## 핵심 키워드

- **N+1 문제 해결**
- **LAZY 로딩 트리거 방지**
- **배치 조회 패턴**
- **인덱스 활용 (복합 인덱스)**
- **ORM 최적화 (JPA/Hibernate)**
- **데이터베이스 연결 풀 관리**
- **트랜잭션 관리**
- **성능 측정 및 모니터링**
- **확장성 고려한 설계**
- **아키텍처 개선 (서비스 분리)**
- **조인 폭발 방지**
- **실제 운영 경험**

---

## 추가 어필 포인트

### 1. 데이터베이스 성능 모니터링
- 실제 운영 환경에서 쿼리 수 측정
- 쿼리 실행 시간 측정
- 메모리 사용량 측정

### 2. 데이터베이스 설계
- 복합 인덱스 설계
- 조회 패턴 고려한 인덱스 설계
- 엔티티 간 관계 설계
- GROUP BY를 활용한 집계 쿼리 최적화

### 3. 문제 해결 프로세스
- 문제 발견 → 분석 → 해결 → 검증
- 정량적 측정을 통한 검증
- 문서화를 통한 지식 공유

### 4. 아키텍처 개선
- 서비스 분리를 통한 책임 분리
- API 설계를 통한 필요한 데이터만 조회
- 조인 폭발 방지를 통한 확장성 향상
